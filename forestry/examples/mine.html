<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/addons/p5.dom.js"></script>
    <script src="../lib/p5.speech.js"></script>
    <script>
        var mySpeech = new p5.Speech();
        var myRec = new p5.SpeechRec('en-US', checkAudio);

        myRec.continuous = true;
        myRec.interimResults = true;

        var redButton, orangeButton, yellowButton, blueButton, greenButton, purpleButton;

        var newColor;

        var mostrecentword;

        var speechResult;

        function setup() {
            createCanvas(800, 800);
            fill(255, 255, 255, 100);
            textSize(72);
            textAlign(CENTER);
            text("Pick a colour", width / 2, 100);

            redButton = createButton('Red');
            redButton.position(100, 430);
            redButton.mousePressed(redFnc);

            blueButton = createButton('Blue');
            blueButton.position(200, 430);
            blueButton.mousePressed(blueFnc);


            greenButton = createButton('Green');
            greenButton.position(300, 430);
            greenButton.mousePressed(greenFnc);
            
            greenButton = createButton('Green');
            greenButton.position(300, 430);
            greenButton.mousePressed(greenFnc);

            //            mySpeech.speak('Welcome to Simon Says');
            myRec.start();

        }

        function draw() {
            background(newColor);            
             
//            fill(0);
//            text(speechResult, width / 2, height / 2);
        }

        function redFnc() {
            newColor = "red";
            console.log("the color is " + newColor)
            mySpeech.speak(newColor);
        }


        function blueFnc() {
            newColor = "blue";
            console.log("the color is " + newColor)
            mySpeech.speak(newColor);
        }

        function greenFnc() {
            newColor = "green";
            console.log("the color is " + newColor)

            mySpeech.speak(newColor);
        }

        function checkAudio() {

            mostrecentword = myRec.resultString;
            //.split(' ').pop();

            console.log(mostrecentword);

            if (mostrecentword.indexOf(newColor) !== -1) {
                console.log("congrats!");
                speechResult = "congrats";
            } else {
                console.log("try again");
                speechResult = "try again!";

            }
    
        }

        function mousePressed() {}

    </script>
</head>

<body>
</body>

</html>
